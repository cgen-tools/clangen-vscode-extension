{
    "title": "Clangen Short Event Schema",
    "description": "Short moonskip events in Clan Generator.",
    "type": "array",
    "items": {
        "type": "object",
        "properties": {
            "event_id": {
                "description": "Unique string used to identify the event.",
                "type": "string"
            },
            "location": {
                "description": "Controls the biome and camp the event appears in.",
                "type": "array",
                "items": {
                    "type": "string"
                }
            },
            "season": {
                "description": "List of seasons in which the event may occur.",
                "enum": [
                    "greenleaf",
                    "leaf-fall",
                    "leaf-bare",
                    "newleaf",
                    "any"
                ]
            },
            "sub_type": {
                "description": "List of subtypes for this event.",
                "enum": [
                    "war",
                    "murder",
                    "old_age",
                    "mass_death",
                    "adoption",
                    "murder_reveal",
                    "accessory",
                    "ceremony"
                ]
            },
            "tags": {
                "description": "Used for some filtering purposes",
                "type": "array",
                "items": {
                    "anyOf": [
                        {
                            "enum": [
                                "classic",
                                "cruel_season",
                                "no_body",
                                "skill_trait_required",
                                "clan_wide",
                                "all_lives",
                                "some_lives",
                                "lives_remain",
                                "high_lives",
                                "mid_lives",
                                "low_lives",
                                "clan:apps"
                            ]
                        },
                        {
                            "type": "string",
                            "pattern": "^clan:[a-zA-Z]+$"
                        }
                    ]
                }
            },
            "weight": {
                "description": "Controls how common an event is. A \"normal\" event would be ~20. A lower number makes the event less common, and a higher number makes the event more common.",
                "type": "integer"
            },
            "event_text": {
                "description": "Text that appears within the event list when the event occurs.",
                "type": "string"
            },
            "new_accessory": {
                "description": "If the event gives a new accessory, list possible new accessories here (one will be chosen from the list)",
                "type": "array",
                "items": {
                    "type": "string"
                }
            },
            "m_c": {
                "description": "Specifies the requirements for the main cat (m_c) of the event.",
                "type": "object",
                "$comment": "todo"
            },
            "r_c": {
                "description": "Specifies the requirements for the random cat (r_c) of the event.",
                "type": "object",
                "$comment": "todo"
            },
            "new_cat": {
                "description": "Adds a new cat.",
                "$comment": "todo"
            },
            "injury": {
                "type": "object",
                "properties": {
                    "cats": {
                        "description": "Which cats are injured.",
                        "type": "array",
                        "items": {
                            "anyOf": [
                                {
                                    "enum": [
                                        "m_c",
                                        "r_c"
                                    ]
                                },
                                {
                                    "type": "string",
                                    "pattern": "^n_c:[0-9]+$"
                                }
                            ]
                        }
                    },
                    "injuries": {
                        "description": "Pool of injuries to draw from.",
                        "type": "array",
                        "items": {
                            "type": "string"
                        }
                    },
                    "scars": {
                        "description": "Pool of scars to draw from. If in classic mode, a scar is chosen from this pool to be given instead of an injury. If in expanded mode, a scar is chosen from this pool to possibly be given upon healing their injury.",
                        "type": "array",
                        "items": {
                            "type": "string"
                        }
                    }
                }
            },
            "history_text": {
                "type": "object",
                "properties": {
                    "cats": {
                        "description": "List of cats for whom the history will be assigned.",
                        "type": "array",
                        "items": {
                            "anyOf": [
                                {
                                    "enum": [
                                        "m_c",
                                        "r_c"
                                    ]
                                },
                                {
                                    "type": "string",
                                    "pattern": "^n_c:[0-9]+$"
                                }
                            ]

                        }
                    },
                    "reg_death": {
                        "description": "Death history text for non-leaders. Whole sentence. Must be included if the cat is dead or injured.",
                        "type": "string"
                    },
                    "lead_death": {
                        "description": "Death history text for leaders. Sentence fragment. Must be included if the dead or injured cat could be the leader.",
                        "type": "string"
                    },
                    "scar": {
                        "description": "Scar history. Whole sentence. Must be included if cat gets injured.",
                        "type": "string"
                    }
                }
            },
            "outsider": {
                "description": "Dictates what reputation the clan is required to have with outsiders as well as how that reputation changes due to the event.",
                "type": "object",
                "properties": {
                    "current_rep": {
                        "description": "The reputation the Clan must have in order for this event to be possible.",
                        "type": "array",
                        "items": {
                            "enum": [
                                "hostile",
                                "neutral",
                                "welcoming",
                                "any"
                            ]
                        }
                    },
                    "changed": {
                        "description": "How the reputation of the Clan changes as a result of this event",
                        "type": "integer"
                    }
                },
                "required": [
                    "current_rep",
                    "changed"
                ]
            },
            "other_clan": {
                "description": "Dictates what reputation the clan is required to have with the other clan as well as how that reputation changes due to the event.",
                "type": "object",
                "properties": {
                    "current_rep": {
                        "description": "The reputation the Clan must have in order for this event to be possible.",
                        "type": "array",
                        "items": {
                            "enum": [
                                "hostile",
                                "neutral",
                                "welcoming",
                                "any"
                            ]
                        }
                    },
                    "changed": {
                        "description": "How the reputation of the Clan changes as a result of this event",
                        "type": "integer"
                    }
                },
                "required": [
                    "current_rep",
                    "changed"
                ]
            },
            "supplies": {
                "type": "array",
                "items": {
                    "type": "object",
                    "properties": {
                        "type": {
                            "description": "Indicates the supply being affected.",
                            "anyOf": [
                                {
                                    "type": "string",
                                    "$comment": "TODO: herb list"
                                },
                                {
                                    "enum": [
                                        "freshkill",
                                        "all_herb",
                                        "any_herb"
                                    ]
                                }
                            ]
                        },
                        "trigger": {
                            "description": "Indicates when the event can trigger. Must include all possible trigger times.",
                            "type": "array",
                            "items": {
                                "enum": [
                                    "always",
                                    "low",
                                    "adequate",
                                    "full",
                                    "excess"
                                ]
                            }
                        },
                        "adjust": {
                            "description": "Indicates how the supply should be adjusted.",
                            "anyOf": [
                                {
                                    "enum": [
                                        "reduce_eight",
                                        "reduce_quarter",
                                        "reduce_half",
                                        "reduce_full"
                                    ]        
                                },
                                {
                                    "type": "string",
                                    "pattern": "^increase_[0-9]+$"
                                }
                            ]
                        }
                    }
                }
            }
        }
    }
}
